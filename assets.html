<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Assets Management</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 1000px;
        margin: 20px auto;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
        font-family: monospace;
      }
      th,
      td {
        border: 1px solid #999;
        padding: 6px 10px;
        text-align: left;
      }
      th {
        background: #eee;
      }
      select,
      input[type="text"],
      input[type="number"] {
        width: 100%;
        padding: 5px;
        box-sizing: border-box;
      }
      button {
        margin-top: 10px;
        padding: 6px 12px;
      }
      nav a {
        margin-right: 15px;
      }
    </style>
  </head>
  <body>
    <h2>Assets Management</h2>
    <nav>
      <a href="needs.html">Go to Needs</a>
      <a href="index.html">Go to SWP Simulation</a>
    </nav>

    <table id="assetsTable">
      <thead>
        <tr>
          <th>Asset Class</th>
          <th>Asset Sub Class</th>
          <th>Goal (Bucket 1/2)</th>
          <th>Holder</th>
          <th>Asset Detail</th>
          <th>Existing Allocation (₹)</th>
          <th>Actions</th>
        </tr>
        <tr id="inputRow">
          <td>
            <select id="assetClassSelect">
              <option value="">--Select--</option>
              <option>Equity</option>
              <option>Debt</option>
              <option>Liquid</option>
              <option>Commodity</option>
              <option>Real Estate</option>
            </select>
          </td>
          <td>
            <select id="assetSubClassSelect">
              <option value="">--Select--</option>
              <option>Equity Mutual Funds</option>
              <option>Hybrid Mutual Funds</option>
              <option>NPS</option>
              <option>EPF</option>
              <option>FD</option>
              <option>SSY</option>
              <option>Debt Mutual Fund</option>
              <option>Liquid Funds</option>
              <option>SA Balance</option>
              <option>Physical Gold</option>
              <option>REIT</option>
              <option>Flat</option>
              <option>Shop</option>
              <option>Plots</option>
            </select>
          </td>
          <td>
            <select id="goalSelect">
              <option value="">--Select--</option>
              <option value="Bucket 1">Bucket 1</option>
              <option value="Bucket 2">Bucket 2</option>
            </select>
          </td>
          <td>
            <select id="holderSelect">
              <option value="">--Select--</option>
              <option>Swapnil</option>
              <option>Sonu</option>
              <option>Swastika</option>
            </select>
          </td>
          <td>
            <input
              type="text"
              id="assetDetailInput"
              placeholder="Asset Detail"
            />
          </td>
          <td>
            <input
              type="number"
              id="existingAllocationInput"
              min="0"
              step="1000"
              placeholder="Amount in ₹"
            />
          </td>
          <td><button id="addAssetBtn">Add</button></td>
        </tr>
      </thead>
      <tbody id="assetsBody"></tbody>
    </table>

    <script>
      const assetsKey = "assetsData";

      // Load assets from localStorage or empty
      function loadAssets() {
        const data = localStorage.getItem(assetsKey);
        return data ? JSON.parse(data) : [];
      }

      // Save assets to localStorage
      function saveAssets(data) {
        localStorage.setItem(assetsKey, JSON.stringify(data));
      }

      function renderAssets() {
        const tbody = document.getElementById("assetsBody");
        const assets = loadAssets();
        tbody.innerHTML = "";
        assets.forEach((a, i) => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
          <td>${a.assetClass}</td>
          <td>${a.assetSubClass}</td>
          <td>${a.goal}</td>
          <td>${a.holder}</td>
          <td>${a.assetDetail}</td>
          <td style="text-align:right;">${Number(
            a.existingAllocation
          ).toLocaleString("en-IN")}</td>
          <td>
            <button onclick="editAsset(${i})">Edit</button>
            <button onclick="deleteAsset(${i})">Delete</button>
          </td>
        `;
          tbody.appendChild(tr);
        });
      }

      function clearInputFields() {
        document.getElementById("assetClassSelect").value = "";
        document.getElementById("assetSubClassSelect").value = "";
        document.getElementById("goalSelect").value = "";
        document.getElementById("holderSelect").value = "";
        document.getElementById("assetDetailInput").value = "";
        document.getElementById("existingAllocationInput").value = "";
        editingIndex = -1;
        document.getElementById("addAssetBtn").textContent = "Add";
      }

      let editingIndex = -1;

      document.getElementById("addAssetBtn").addEventListener("click", () => {
        const assetClass = document
          .getElementById("assetClassSelect")
          .value.trim();
        const assetSubClass = document
          .getElementById("assetSubClassSelect")
          .value.trim();
        const goal = document.getElementById("goalSelect").value.trim();
        const holder = document.getElementById("holderSelect").value.trim();
        const assetDetail = document
          .getElementById("assetDetailInput")
          .value.trim();
        const existingAllocation = Number(
          document.getElementById("existingAllocationInput").value
        );

        if (
          !assetClass ||
          !assetSubClass ||
          !goal ||
          !holder ||
          !assetDetail ||
          !existingAllocation ||
          existingAllocation < 0
        ) {
          alert("Please fill all fields with valid values.");
          return;
        }

        const assets = loadAssets();

        if (editingIndex === -1) {
          assets.push({
            assetClass,
            assetSubClass,
            goal,
            holder,
            assetDetail,
            existingAllocation,
          });
        } else {
          assets[editingIndex] = {
            assetClass,
            assetSubClass,
            goal,
            holder,
            assetDetail,
            existingAllocation,
          };
        }

        saveAssets(assets);
        renderAssets();
        clearInputFields();
      });

      function editAsset(i) {
        const assets = loadAssets();
        const a = assets[i];
        document.getElementById("assetClassSelect").value = a.assetClass;
        document.getElementById("assetSubClassSelect").value = a.assetSubClass;
        document.getElementById("goalSelect").value = a.goal;
        document.getElementById("holderSelect").value = a.holder;
        document.getElementById("assetDetailInput").value = a.assetDetail;
        document.getElementById("existingAllocationInput").value =
          a.existingAllocation;
        editingIndex = i;
        document.getElementById("addAssetBtn").textContent = "Update";
      }

      function deleteAsset(i) {
        if (!confirm("Delete this asset?")) return;
        const assets = loadAssets();
        assets.splice(i, 1);
        saveAssets(assets);
        renderAssets();
        clearInputFields();
      }

      // Initial render
      renderAssets();
    </script>
  </body>
</html>
